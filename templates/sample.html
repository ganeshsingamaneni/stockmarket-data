<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>news paper</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <style>
        .form-control:focus {
            box-shadow: 0 0 0 0rem rgba(0, 0, 0, 0);
        }
        
        .card {
            box-shadow: 1px 3px 17px 1px rgba(0, 0, 0, .15) !important;
            border: none;
            border-radius: 8px;
        }
        
        .card img {
            border-radius: 8px;
        }
        
        select option {
            border: 1px solid rgba(211, 211, 211, 0.336) !important;
        }
        
        @media only screen and (min-width: 320px) and (max-width:765px) {
            .currentdt {
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="padding-nav pt-2 pb-2 shadow">

        <div class="container d-flex justify-content-between">
            <div>
                <!-- https://newspapergrid.herokuapp.com/static/greenparklogo.png -->

                <a href="http://hotelgreenpark.com/greenpark/"><img class="logoimg" src="https://newspapergrid.herokuapp.com/static/greenparklogo.png" alt="greenpark logo"></a>

            </div>
            <div class="mt-3">
                <select id="language" class="form-control" style="border: none; border-bottom: 1px solid lightgreen; border-radius:0 ; outline:0 ;cursor: pointer;text-transform: capitalize;">

                </select>
            </div>
        </div>

    </div>
    <div class="container pt-4">
        <div class="col">
            <h4 class="currentdt" id="currentDate">Please Wait

        </div>
        </h4>
        <div class="row m-0 mt-3" id="newsContainer">
            <div style="height: 50vh;" class="d-flex w-100">
                <h6 class="text-center w-100" style="display: flex;margin: auto;justify-content: center;color:gray">
                    Please wait papers are loading...</h6>
            </div>
        </div>
    </div>

</body>

</html>
<script>
    var languages = new Set();

    var newspapers = [];
    // api / getnewspapers / 2020 - 04 - 28
    const domain = 'http://0.0.0.0:5000';
    const date = window.location.search.split('=')[1];

    window.onload = () => {
        document.getElementById('currentDate').innerText = moment(date).format('dddd, MMMM Do YYYY');
        fetch(domain + '/api/getaddsearchedscripts/' + date).then(res => res.json()).then((res) => {
            console.log(res, "this is the res")
            newspapers = res.data;
            if (newspapers.length == 0) {
                document.getElementById('newsContainer').innerHTML = `document.getElementById('newsContainer').innerHTML = <div class="col-lg-4">
                <div class="card shadow mt-3 " style="min-height:150px;">
                   No papers are uploaded on this day
                </div>
            </div>`;
            }
            res.data.forEach(element => {
                languages.add(element.NewsPaperDetails.language);
            });
            updateLanguages();
            updateNewsList(newspapers);
        });
        document.getElementById('language').addEventListener('change', (event) => {
            console.log(event.target.value);
            if (event.target.value) {
                const temp = newspapers.filter((each) => each.NewsPaperDetails.language == event.target.value);
                console.log('temp', temp)
                updateNewsList(temp);
            } else {
                updateNewsList(newspapers);
            }
        })
    }

    function updateLanguages() {
        const lang = Array.from(languages).map(element => {
            return `<option value="${element}" class="text-capitalize">${element}</option>`
        }).join('');
        document.getElementById('language').innerHTML = `<option selected="true"  disabled="disabled">Select Language</option>` + lang;
    }

    function updateNewsList(list) {
        const news = list.map(element => {
            return `<div class="col-lg-3">
                <div class="card shadow mt-3" style="min-height:150px;">
                   <a href="${domain + element.paperpath}"> <img src="${domain + element.NewsPaperDetails.paperlogo}" alt="" height="150px" width="100%"></a>
                </div>
            </div>`
        }).join('');
        document.getElementById('newsContainer').innerHTML = news;
        // console.log(news, 'dfgadsgsdgs');
    }
</script>
